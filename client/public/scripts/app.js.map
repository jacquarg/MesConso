{"version":3,"file":"public/scripts/app.js","sources":["app/application.js","app/collections/persons.js","app/collections/receipts.js","app/collections/sections.js","app/initialize.js","app/models/person.js","app/models/receipt.js","app/models/section.js","app/router.js","app/templates/home.jade","app/templates/intermarche.jade","app/templates/person.jade","app/templates/receipt.jade","app/templates/receiptdetail.jade","app/templates/section.jade","app/views/app_view.js","app/views/intermarche.js","app/views/person.js","app/views/receipt.js","app/views/section.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AALA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AALA;;A,CCAA;;AACA;AACA;AACA;AAHA;;A,CCAA;;AACA;AACA;AACA;AAHA;;A,CCAA;;AACA;AACA;AACA;AACA;AAJA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/EA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7BA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhCA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxCA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjCA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnCA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvDA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;;A","sourcesContent":["module.exports = {\n\n    initialize: function() {\n        var Router = require('router');\n        this.router = new Router();\n        Backbone.history.start();\n    }\n};","Person = require('../models/person');\nmodule.exports = Persons = Backbone.Collection.extend({\n\n    url: 'persons',\n    model: Person\n\n});\n","Receipt = require('../models/receipt');\nmodule.exports = ReceiptDetails = Backbone.Collection.extend({\n    model: Receipt,\n    url: 'receipts'\n})\n","Receipt = require('../models/section');\nmodule.exports = Sections = Backbone.Collection.extend({\n\n    initialize: function(models, options) {\n        this.receiptId = options.receiptId;\n    },\n    \n    url: function() {\n        return '/receipts/' + this.receiptId + '/sections';\n    },\n    model: Section,\n\n});\n","// The function called from index.html\n$(document).ready(function() {\n    var app = require('application');\n    app.initialize()\n});\n","module.exports = Person = Backbone.Model.extend({\n\n});\n","module.exports = Receipt = Backbone.Model.extend({\n\n})\n","module.exports = Section = Backbone.Model.extend({\n\n});\n\n","var AppView = require('views/app_view');\n//var ReceiptDetailCollection = require('collections/receiptdetails');\n\n//var receiptDetails = new ReceiptDetailCollection();\n\nmodule.exports = Router = Backbone.Router.extend({\n\n    routes: {\n        '': 'main'\n    },\n\n    main: function() {\n        var mainView = new AppView({\n  //          collection: receiptDetails\n        });\n        mainView.render();\n    }\n});\n","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"container\"><div id=\"fix\"></div><div class=\"miframe\"><div class=\"miframeheader\"><h2>MesInfos de consommation</h2></div><div class=\"miframeinner\"><div class=\"text-center\"><img id=\"courses\" src=\"img/Intermarche.png\"/></div><div id=\"content\"></div></div></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"consocontainer\"><div class=\"consoheader\"><h3>Mes courses</h3></div><div id=\"list\" class=\"consoinner\"></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"miframe\"><div class=\"miframeheader\"><h2>MesInfos</h2></div><div class=\"miframeinner\"><div class=\"row person\"><div class=\"col-md-5\"><div class=\"row\"><div class=\"col-xs-3\"><img src=\"img/Bonhomme.png\" class=\"img-responsive\"/></div><div class=\"col-xs-9\"><p class=\"nomprenom\">');\nvar __val__ = person.firstname\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('&nbsp;');\nvar __val__ = person.lastname\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p>');\n var bDate = new Date(person.birthdate)\n //p= person.birthdate\nbuf.push('<p>');\nvar __val__ = bDate.toDateString()\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p><p>');\nvar __val__ = person.address1\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('<br/>');\nvar __val__ = person.postcode\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('&nbsp;');\nvar __val__ = person.city\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('<br/>');\nvar __val__ = person.countryCode\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p></div></div></div><div class=\"col-md-7\"><div class=\"row\"><div class=\"col-sm-6\"><p>0');\nvar __val__ = person.phoneNumber\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p><p>');\nvar __val__ = person.email\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p><p>');\n if (person.childrenCount == 0)\n{\nbuf.push('Aucun enfant');\n}\n else\n{\nvar __val__ = person.childrenCount\nbuf.push(escape(null == __val__ ? \"\" : __val__));\n if (person.childrenCount == 1)\n{\nbuf.push('&nbsp; enfant');\n}\n else\n{\nbuf.push('&nbsp; enfant ');\n}\n}\n if (person.birthdateChild1)\n var c1BD = new Date(person.birthdateChild1)\n{\nbuf.push('<br/>');\nvar __val__ = c1BD.toDateString()\nbuf.push(escape(null == __val__ ? \"\" : __val__));\n}\n if (person.birthdateChild2)\n var c2BD = new Date(person.birthdateChild2)\n{\nbuf.push('<br/>');\nvar __val__ = c2BD\nbuf.push(escape(null == __val__ ? \"\" : __val__));\n}\nbuf.push('</p></div><div class=\"col-sm-6\"><p>');\nvar __val__ = person.csp\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p><p>');\nvar __val__ = person.maritalStatus\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p><p>');\nvar __val__ = person.drivingLicence\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</p></div></div></div></div></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"row receipt\"><div class=\"col-md-6\"><div class=\"row\"><div class=\"col-xs-2 box map\"><a');\nbuf.push(attrs({ 'href':(\"http://fc1.1bis.com/intermarche/map.asp?id=IMARC\" + (receipt.intermarcheShopId) + \"\"), 'target':(\"_blank\") }, {\"href\":true,\"target\":true}));\nbuf.push('><img src=\"img/pin.png\"/></a></div><div class=\"col-xs-5 box\">');\n var dt = new Date(receipt.timestamp)\nvar __val__ = dt.getDate()\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('/');\nvar __val__ = dt.getMonth()\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</div><div class=\"col-xs-5 box\">');\nvar __val__ = dt.getHours()\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push(':');\nvar __val__ = dt.getMinutes()\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</div></div></div><div class=\"col-md-6\"><div class=\"row\"><div class=\"col-xs-5 box\">');\nvar __val__ = receipt.articlesCount\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('&nbsp; articles</div><div class=\"col-xs-5 box price\">');\nvar __val__ = receipt.total\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('€</div><div class=\"col-xs-2 box toggle\"><img src=\"img/plus.png\"/></div></div></div></div><div class=\"sections\"></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"col-md-4\"><div class=\"row receiptdetail\"><div class=\"col-xs-4\"><img');\nbuf.push(attrs({ 'src':('http://drive.intermarche.com/ressources/images/produit/vignette/0' + (receiptDetail.barcode) + '.jpg'), \"class\": ('image') }, {\"src\":true}));\nbuf.push('/></div><div class=\"col-xs-8\">');\n var label = receiptDetail.label.toLowerCase();\n var parts = label.split(' ');\n var vol = parts.pop();\n parts.join(' ');\nbuf.push('<div class=\"lab\">');\nvar __val__ = label\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</div>');\n //p.vol= vol\n //p= receiptDetail.amount \n //   | X\nbuf.push('<div class=\"price\">');\nvar __val__ = receiptDetail.price\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('&nbsp;€ </div></div></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"sectionhead\"><img');\nbuf.push(attrs({ 'src':(\"img/Sections/\" + (section.section) + \".png\"), \"class\": ('sectionlogo') }, {\"src\":true}));\nbuf.push('/></div><div class=\"sectioninner\"><div class=\"row section\">');\n for (var i2 in section.receiptDetails) {\n   var receiptDetail = section.receiptDetails[i2];\nbuf.push('<div class=\"col-md-4\"><div class=\"row receiptdetail\"><div class=\"col-xs-4\"><img');\nbuf.push(attrs({ 'src':('http://drive.intermarche.com/ressources/images/produit/vignette/0' + (receiptDetail.barcode) + '.jpg'), \"class\": ('image') }, {\"src\":true}));\nbuf.push('/></div><div class=\"col-xs-8\">');\n var label = receiptDetail.label.toLowerCase();\n var parts = label.split(' ');\n var vol = parts.pop();\n parts.join(' ');\nbuf.push('<div class=\"lab\">');\nvar __val__ = label\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('</div>');\n //p.vol= vol\n //p= receiptDetail.amount \n //   | X\nbuf.push('<div class=\"price\">');\nvar __val__ = receiptDetail.price\nbuf.push(escape(null == __val__ ? \"\" : __val__));\nbuf.push('&nbsp;€ </div></div></div></div>');\n }\nbuf.push('</div></div>');\n}\nreturn buf.join(\"\");\n};","var IntermarcheView = require('./intermarche');\nvar ReceiptCollection = require('collections/receipts');\nvar PersonView = require('./person');\n\nmodule.exports = AppView = Backbone.View.extend({\n\n    el: 'body',\n    template: require('../templates/home'),\n\n    // initialize is automatically called once after the view is constructed\n    initialize: function() {\n        console.log(\"Initialize\")\n    },\n    events: {\n        \"click #courses\": \"getCourses\"\n    },\n    \n    getCourses: function() {\n        var receipts = new ReceiptCollection();\n        intermarcheView = new IntermarcheView({\n            collection: receipts\n        });\n\n        intermarcheView.render()\n        this.$el.find('#content').append(intermarcheView.$el);\n\n    },\n\n    render: function() {\n\n        // we render the template\n        this.$el.html(this.template());\n\n        var personView = new PersonView();\n        personView.render();\n\n        this.$el.find('#fix').append(personView.$el);\n    },\n\n});\n","var ReceiptView = require('./receipt');\n\nmodule.exports = AppView = Backbone.View.extend({\n\n    el: '#content',\n    template: require('../templates/intermarche'),\n\n    // initialize is automatically called once after the view is constructed\n    initialize: function() {\n        this.listenTo(this.collection, \"add\", this.onReceiptAdded);\n    },\n\n    render: function() {\n\n        // we render the template\n        this.$el.html(this.template());\n\n        // fetch the bookmarks from the database\n        this.collection.fetch();\n    },\n\n\n    onReceiptAdded: function(receipt) {\n        // render the specific element\n        receiptView = new ReceiptView({\n            model: receipt\n        });\n        receiptView.render();\n        this.$el.find('#list').append(receiptView.$el);\n    }\n\n\n});\n","var PersonCollection = require('../collections/persons');\n\nmodule.exports = Person = Backbone.View.extend({\n\n    tagName: 'div',\n    template: require('../templates/person'),\n\n    // initialize is automatically called once after the view is constructed\n    initialize: function() {\n        this.collection = new PersonCollection();\n        this.listenTo(this.collection, \"add\", this.onPersonAdded);\n    },\n\n    render: function() {\n\n //       // we render the template\n\n        // fetch the bookmarks from the database\n        this.collection.fetch();\n    },\n\n\n    onPersonAdded: function(person) {\n        if (this.oneTime) {\n            return;\n        }\n        this.oneTime = true;\n\n        this.$el.html(this.template({\n            person: person.toJSON()\n        }));\n\n    }\n\n});\n","var SectionView = require('./section');\nvar SectionCollection = require('../collections/sections');\n\nmodule.exports = Receipt = Backbone.View.extend({\n\n    tagName: 'div',\n    template: require('../templates/receipt'),\n    events: {\n        \"click .receipt\": \"toggleSections\"    \n    },\n\n    initialize: function() {\n        this.collection = new SectionCollection([], { receiptId: this.model.attributes.receiptId });\n        \n    },\n\n    render: function() {\n        this.$el.html(this.template({\n            receipt: this.model.toJSON()\n        }));\n\n\n    \n    },\n\n    toggleSections: function(event) {\n        if (!this.open) {\n            this.open = true;\n            // submit button reload the page, we don't want that\n            //event.preventDefault();\n        \n            this.listenTo(this.collection, \"add\", this.onSectionAdded);\n            // fetch the bookmarks from the database\n            this.collection.fetch();\n\n        } else {\n            this.stopListening(this.collection);\n            this.$el.find('.sections').empty();\n\n            this.open = false;\n        }\n    },\n\n    onSectionAdded: function(section) {\n        console.log(\"added section\");\n        // render the specific element\n        sectionView = new SectionView({\n            model: section\n        });\n        sectionView.render();\n        this.$el.find('.sections').append(sectionView.$el);\n    }\n    \n});\n\n","module.exports = Section = Backbone.View.extend({\n\n    tagName: 'div',\n    template: require('../templates/section'),\n\n    render: function() {\n        this.$el.html(this.template({\n            section: this.model.toJSON()\n        }));\n    },\n\n});\n\n"]}